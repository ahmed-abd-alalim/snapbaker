import './projects.css'
import { useState } from 'react'

// import components
import { ProjectForm } from '@/home-screen/components/'

// import context
import { useDataContext } from '@/home-screen/assets/context/data'
import { useSettingContext } from '@/home-screen/assets/context/setting'

// import type
import { projectFromOpjectType } from '@/type/home-screen'

// import icon
import { PiTrash, PiCalendarDotsLight } from 'react-icons/pi'
import { TbEdit } from 'react-icons/tb'

// import img
import fLayer from '/images/projects-layers/1.png'
import sLayer from '/images/projects-layers/2.png'
import tLayer from '/images/projects-layers/3.png'
import Fire from '/images/fire.png'

const Index = (): React.JSX.Element => {
  const { projectsData, setProjectsData } = useDataContext()
  const {
    projectFromVisibility,
    setProjectFromVisibility,
    setActiveSessionName,
    activeSessionName
  } = useSettingContext()

  const [formData, setFormData] = useState<projectFromOpjectType>()

  const HandleOpenProject: (projectName: string) => void = (projectName) => {
    if (!activeSessionName) {
      setActiveSessionName(projectName)
      window.newWindow.openNewWindow()
    }
  }

  const HandleCardOpen: (
    event: React.MouseEvent<HTMLDivElement>,
    cardData: projectFromOpjectType
  ) => void = (event, cardData) => {
    event.stopPropagation()
    if (cardData.siteName !== activeSessionName) {
      setFormData(cardData)
      setProjectFromVisibility({
        projects: 1
      })
    }
  }

  const HandleDeletCard: (
    event: React.MouseEvent<HTMLDivElement>,
    cardData: projectFromOpjectType
  ) => void = (event, cardData) => {
    event.stopPropagation()
    if (cardData.siteName !== activeSessionName) {
      const newData = projectsData.filter((item) => item.siteName !== cardData.siteName)
      setProjectsData([...newData])
      window.systemFile.deleteApp(cardData.siteName!)
    }
  }

  return (
    <>
      <section id="Projects">
        {projectsData.length === 0 ? (
          <div className="empty_layer">
            <img src={fLayer} alt="" width={'100%'} className="fLayer" />
            <img src={sLayer} alt="" width={'100%'} className="sLayer" />
            <img src={tLayer} alt="" width={'100%'} className="tLayer" />
          </div>
        ) : (
          <div className="container">
            <div className="row">
              {projectsData.map((item, i) => (
                <div key={i} className="col-12 col-md-6 col-lg-4 p-1 card_transition">
                  <div
                    className={` ${activeSessionName === item.siteName && 'stop-hover'} site_card`}
                    onClick={() => HandleOpenProject(item.siteName!)}
                  >
                    {activeSessionName === item.siteName && (
                      <div className="up_layer_for_work_project">
                        <div className="anymation_circle"> </div>
                        <div className="speed_shadow">
                          <div className="speed_shadow_line"></div>
                          <div className="speed_shadow_line ms-3"></div>
                          <div className="speed_shadow_line ms-4"></div>
                          <div className="speed_shadow_line ms-3"></div>
                          <div className="speed_shadow_line"></div>
                        </div>
                        <div className="logo_section ">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 650 650"
                            version="1.1"
                            width="100%"
                          >
                            <path
                              className="resizable-path"
                              d="M 531.324219 373.75 C 530.519531 376.046875 529.863281 378.507812 529.355469 381.136719 C 529.796875 418.914062 530.125 456.828125 530.339844 494.886719 C 528.242188 496.753906 527.914062 498.886719 529.355469 501.289062 C 528.855469 503.085938 528.03125 503.25 526.894531 501.78125 C 526.566406 502.765625 526.238281 503.75 525.910156 504.734375 C 521.816406 506.855469 519.191406 510.136719 518.03125 514.582031 C 516.960938 512.1875 516.46875 512.515625 516.554688 515.566406 C 515.144531 515.492188 513.832031 515.816406 512.613281 516.554688 C 511.269531 519.03125 509.300781 520.839844 506.703125 521.96875 C 504.671875 525.554688 501.882812 528.34375 498.332031 530.339844 C 496.683594 532.398438 496.191406 534.535156 496.855469 536.742188 C 495.253906 536.550781 493.613281 536.550781 491.933594 536.742188 C 485.859375 544.128906 479.128906 550.859375 471.742188 556.933594 C 470.378906 561.140625 467.589844 564.09375 463.371094 565.796875 C 462.277344 567.652344 461.457031 569.621094 460.910156 571.703125 C 459.742188 570.492188 458.59375 570.492188 457.460938 571.703125 C 457.132812 575.316406 455.164062 577.285156 451.554688 577.613281 C 448.226562 581.332031 444.78125 584.941406 441.210938 588.445312 C 441.148438 590.792969 440.328125 591.449219 438.75 590.417969 C 434.414062 595.574219 429.65625 600.171875 424.46875 604.203125 C 423.863281 605.140625 424.027344 605.960938 424.960938 606.667969 C 424.027344 607.273438 423.207031 607.109375 422.5 606.175781 C 422.171875 607.160156 421.84375 608.144531 421.515625 609.128906 C 419.570312 610.25 417.765625 611.5625 416.097656 613.066406 C 416.304688 613.644531 416.632812 614.136719 417.082031 614.546875 C 415.558594 615.742188 414.410156 617.21875 413.636719 618.976562 C 412.472656 617.765625 411.324219 617.765625 410.1875 618.976562 C 407.8125 622.710938 404.695312 625.664062 400.832031 627.839844 C 400.199219 630.234375 398.722656 631.875 396.402344 632.765625 C 395.757812 634.355469 395.265625 635.996094 394.925781 637.6875 C 394.515625 637.238281 394.023438 636.910156 393.445312 636.703125 C 392.679688 637.914062 392.183594 639.226562 391.96875 640.644531 C 391.5625 640.195312 391.070312 639.863281 390.492188 639.660156 C 389.671875 640.644531 388.851562 641.628906 388.03125 642.613281 C 386.65625 641.699219 385.179688 641.699219 383.597656 642.613281 C 380.472656 642.078125 377.519531 641.09375 374.734375 639.660156 C 374.078125 637.03125 373.421875 634.40625 372.765625 631.78125 C 373.335938 613.570312 373.664062 595.183594 373.75 576.628906 C 373.445312 562.824219 372.789062 549.035156 371.78125 535.265625 C 372.261719 510.921875 372.261719 486.628906 371.78125 462.386719 C 370.054688 460.652344 368.085938 459.339844 365.871094 458.445312 C 311.273438 458.78125 256.613281 459.4375 201.894531 460.417969 C 199.265625 460.746094 197.296875 459.761719 195.984375 457.460938 C 195.433594 457.976562 194.777344 458.304688 194.015625 458.445312 C 192.863281 457.621094 191.710938 456.800781 190.566406 455.984375 C 190.082031 452.019531 188.769531 448.410156 186.628906 445.152344 C 187.941406 442.5625 188.761719 439.773438 189.089844 436.78125 C 189.417969 430.214844 189.746094 423.648438 190.074219 417.082031 C 190.289062 372.566406 190.78125 328.246094 191.554688 284.128906 C 190.320312 282.652344 189.335938 281.007812 188.597656 279.203125 C 187.785156 278.332031 186.800781 278.003906 185.644531 278.21875 C 183.96875 277.003906 182 276.347656 179.734375 276.25 C 124.546875 276.175781 69.722656 276.507812 15.265625 277.234375 C 13.070312 276.175781 10.773438 275.515625 8.371094 275.265625 C 8.371094 273.953125 8.371094 272.636719 8.371094 271.324219 C 7.386719 271.324219 6.402344 271.324219 5.417969 271.324219 C 5.417969 268.371094 5.417969 265.417969 5.417969 262.460938 C 6.402344 262.460938 7.386719 262.460938 8.371094 262.460938 C 9.894531 258.449219 12.191406 254.839844 15.265625 251.628906 C 14.277344 249.484375 14.933594 249.15625 17.234375 250.644531 C 21.269531 246.941406 24.550781 242.671875 27.082031 237.839844 C 29.480469 239.210938 30.140625 238.71875 29.054688 236.363281 C 33.289062 234.933594 36.902344 232.472656 39.886719 228.976562 C 43.21875 224.003906 47.488281 219.902344 52.6875 216.667969 C 54.003906 215.023438 55.316406 213.382812 56.628906 211.742188 C 56.300781 211.414062 55.972656 211.085938 55.644531 210.757812 C 57.855469 209.734375 59.988281 208.585938 62.046875 207.3125 C 62.351562 206.085938 61.859375 205.101562 60.566406 204.355469 C 65.113281 203.148438 68.722656 200.195312 71.402344 195.492188 C 71.980469 195.699219 72.472656 196.027344 72.878906 196.476562 C 76.390625 193.054688 79.675781 189.441406 82.726562 185.644531 C 83.402344 184.378906 83.238281 183.230469 82.234375 182.195312 C 83.460938 181.746094 84.28125 182.242188 84.695312 183.675781 C 86.011719 182.363281 87.324219 181.046875 88.636719 179.734375 C 89.246094 178.800781 89.082031 177.980469 88.144531 177.273438 C 90.800781 176.519531 93.261719 175.371094 95.53125 173.824219 C 96.015625 172.214844 96.179688 170.574219 96.023438 168.902344 C 100.511719 167.222656 103.957031 164.265625 106.363281 160.039062 C 108.882812 161.167969 110.195312 160.183594 110.304688 157.082031 C 113.5625 154.820312 116.351562 152.195312 118.675781 149.203125 C 119.988281 149.203125 120.644531 148.546875 120.644531 147.234375 C 127.457031 138.953125 135.171875 131.402344 143.789062 124.582031 C 144.515625 122.886719 145.335938 121.246094 146.25 119.660156 C 148.957031 120.632812 150.925781 119.648438 152.160156 116.703125 C 180.609375 117.503906 209.167969 118.160156 237.839844 118.675781 C 245.0625 118.511719 252.285156 118.347656 259.507812 118.183594 C 263.046875 116.253906 266.492188 116.421875 269.847656 118.675781 C 273.496094 118.09375 276.941406 116.945312 280.1875 115.226562 C 284.074219 111.878906 287.847656 108.429688 291.515625 104.886719 C 294.441406 99.332031 298.710938 95.066406 304.316406 92.082031 C 306.785156 87.304688 310.066406 83.035156 314.167969 79.28125 C 314.652344 78.246094 314.488281 77.261719 313.675781 76.324219 C 315.492188 75.015625 316.96875 75.34375 318.105469 77.3125 C 324.988281 70.917969 331.390625 64.023438 337.3125 56.628906 C 337.886719 56.835938 338.378906 57.164062 338.789062 57.613281 C 339.589844 54.15625 341.722656 51.859375 345.1875 50.71875 C 349.1875 45.074219 353.78125 39.820312 358.976562 34.960938 C 365.25 30.660156 370.5 25.40625 374.734375 19.203125 C 378.019531 18.605469 378.347656 17.457031 375.71875 15.757812 C 378.03125 15.648438 379.507812 14.5 380.152344 12.3125 C 380.480469 12.640625 380.808594 12.96875 381.136719 13.296875 C 381.621094 11.6875 381.785156 10.042969 381.628906 8.371094 C 467.3125 8.371094 552.992188 8.371094 638.675781 8.371094 C 639.402344 11.808594 640.714844 15.089844 642.613281 18.21875 C 643.597656 98.316406 643.925781 178.417969 643.597656 258.523438 C 642.5625 258.375 641.578125 258.539062 640.644531 259.015625 C 639.632812 261.054688 638.8125 263.1875 638.183594 265.417969 C 636.945312 267.628906 635.136719 268.941406 632.765625 269.355469 C 632.917969 270.707031 632.753906 272.023438 632.273438 273.296875 C 631.945312 272.636719 631.617188 271.984375 631.289062 271.324219 C 626.691406 277.234375 621.4375 282.488281 615.53125 287.082031 C 614.234375 288.535156 613.25 290.175781 612.574219 292.007812 C 612.246094 291.679688 611.917969 291.351562 611.589844 291.023438 C 611.285156 292.269531 610.792969 293.417969 610.113281 294.46875 C 604.386719 298.558594 598.96875 302.992188 593.863281 307.765625 C 593.089844 310.800781 591.285156 312.933594 588.445312 314.167969 C 589.132812 315.632812 588.804688 317.109375 587.460938 318.597656 C 586.886719 318.394531 586.390625 318.0625 585.984375 317.613281 C 584.328125 319.4375 582.519531 321.078125 580.566406 322.539062 C 578.683594 324.085938 577.699219 326.054688 577.613281 328.445312 C 576.3125 328.613281 575.164062 328.285156 574.167969 327.460938 C 572.496094 330.609375 570.035156 332.90625 566.78125 334.355469 C 564.136719 338.0625 561.347656 341.675781 558.410156 345.1875 C 557.359375 345.871094 556.207031 346.363281 554.960938 346.667969 C 556.175781 347.832031 556.175781 348.980469 554.960938 350.113281 C 552.019531 352.097656 549.066406 354.066406 546.097656 356.023438 C 545.636719 357.632812 544.652344 358.78125 543.144531 359.46875 C 544.457031 361.28125 544.292969 361.773438 542.652344 360.945312 C 538.425781 364.914062 534.652344 369.183594 531.324219 373.75 Z M 531.324219 373.75 "
                            />

                            <path
                              className="resizable-path"
                              d="M 120.644531 147.234375 C 119.632812 146.84375 119.46875 146.1875 120.152344 145.265625 C 120.609375 145.851562 120.773438 146.507812 120.644531 147.234375 Z M 120.644531 147.234375 "
                            />

                            <path
                              className="resizable-path"
                              d="M 118.675781 149.203125 C 118.015625 147.890625 118.015625 147.890625 118.675781 149.203125 Z M 118.675781 149.203125 "
                            />

                            <path
                              className="resizable-path"
                              d="M 185.644531 278.21875 C 184.988281 278.875 184.988281 278.875 185.644531 278.21875 Z M 185.644531 278.21875 "
                            />

                            <path
                              className="resizable-path"
                              d="M 531.324219 373.75 C 532.335938 374.140625 532.5 374.796875 531.816406 375.71875 C 531.359375 375.132812 531.195312 374.476562 531.324219 373.75 Z M 531.324219 373.75 "
                            />
                          </svg>
                          <div className="filr_section">
                            <img src={Fire} alt="Fire" width={'100%'} />
                          </div>
                        </div>
                      </div>
                    )}
                    <div className="card_bar">
                      <div className="date_setion">
                        <PiCalendarDotsLight className="card_icon" />
                        <span className="date">{item.projectDate}</span>
                      </div>
                      <div className="d-flex">
                        <div
                          className="edit_section"
                          onClick={(event) => HandleCardOpen(event, item)}
                        >
                          <TbEdit className="card_icon" />
                        </div>
                        <div
                          className="delet_section"
                          onClick={(event) => HandleDeletCard(event, item)}
                        >
                          <PiTrash className="card_icon" />
                        </div>
                      </div>
                    </div>
                    <div className="site_name">
                      <span>{item.siteName}</span>
                    </div>
                    <div className="row m-0 site_info">
                      <div className="col-6 site_featcher_section card_transition">
                        <div className="site_featcher_box">
                          <span>CSS framework:</span>
                          <span className="featcher_value">{item.cssFram}</span>
                        </div>
                      </div>
                      <div className="col-6 site_featcher_section card_transition">
                        <div className="site_featcher_box">
                          <span>JS framework:</span>
                          <span className="featcher_value">{item.jsFram}</span>
                        </div>
                      </div>
                      <div className="col-6 site_featcher_section card_transition">
                        <div className="site_featcher_box">
                          <span>Theme color:</span>
                          <span className="featcher_value">{item.themeColor}</span>
                        </div>
                      </div>
                      <div className="col-6 site_featcher_section card_transition">
                        <div className="site_featcher_box">
                          <span>pages numper:</span>
                          <span className="featcher_value">{item.pagesNum}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}
      </section>
      {projectFromVisibility.projects ? <ProjectForm data={formData} /> : ''}
    </>
  )
}

export default Index
